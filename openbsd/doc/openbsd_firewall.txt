#: Title : OpenBSD Firewall
#: Author : "Caio Abreu Ferreira" <abreuferr_gmail.com>
#: Description : servidor firewall NAT
#: Options : None
#: Reference :  

# Um pequeno estudo sobre a firewall do OpenBSD

# Arquivo de configuracao do OpenBSD (PF)
# Permitir que o OpenBSD faca IP Forward
#
$ /etc/sysctl.conf:
	net.inet.ip.forwarding=1

# Arquivo de configuracao do OpenBSD (PF)
#
$ /etc/pf.conf

# Interface externa
ext_if = "vio0"

# Rede interna
int_net = "192.168.100.0/24"

# Configuracao do NAT para traduzir enderecos internos para a interface externa
match out on $ext_if inet from $int_net to any nat-to ($ext_if) round-robin

# Permitir todo o trafego (sem bloqueios)
pass all

# Alguns comandos interessantes para auxiliar na configuracao da firewall
# do OpenBSD
#
$ pfctl -f /etc/pf.conf     Load the pf.conf file
$ pfctl -nf /etc/pf.conf    Parse the file, but don't load it
$ pfctl -sr                 Show the current ruleset
$ pfctl -ss                 Show the current state table
$ pfctl -si                 Show filter stats and counters
$ pfctl -sa                 Show EVERYTHING it can show